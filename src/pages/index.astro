---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE, USER_NAME, GITHUB_USERNAME, SOCIAL_LINKS } from '../consts';
import Avatar from '../assets/avatar.png';
import { Image } from 'astro:assets';
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			/* Ensure the wrapper takes full height */
			.wrapper {
				display: flex;
				flex-direction: column;
				min-height: 100vh;
			}
			/* Main area expands to fill space */
			.main {
				flex: 1;
				display: flex;
				flex-direction: column;
			}
			.page.home {
				display: flex;
				flex-direction: column;
				align-items: center;
				width: 100%;
			}
			/* Exact CSS from fabian4.site */
			.home-profile {
				transform: translateY(16vh);
				padding: 0 0 .5rem;
				text-align: center;
				display: flex;
				flex-direction: column;
				align-items: center;
			}
			.home-avatar {
				padding: .5rem;
			}
			.avatar {
				display: inline-block;
				width: 8rem;
				height: 8rem;
				margin: 0 auto;
				border-radius: 100%;
				box-shadow: 0 0 0 0.3618em rgba(0,0,0,0.05);
				transition: all 0.4s ease;
				object-fit: cover;
				background-color: #fff;
			}
			.avatar:hover {
				transform: translateY(-0.75rem);
			}
			.home-title {
				font-size: 1.25rem;
				font-weight: bold;
				margin: 0;
				padding: 0.25rem;
				color: var(--black);
			}
			.home-subtitle {
				font-size: 1rem;
				font-weight: normal;
				margin: 0;
				padding: 0.25rem;
				color: var(--black);
			}
			.links {
				padding: 0.5rem;
				font-size: 1.8rem; /* Bigger icons */
				display: flex;
				justify-content: center;
				gap: 0.75rem;
			}
			.links a {
				color: var(--black);
				text-decoration: none;
				transition: color 0.2s;
			}
			.links a:hover {
				color: var(--accent);
			}
			.links a i {
				vertical-align: text-bottom;
			}
			.github-chart {
				width: 100%;
				max-width: 800px;
				height: auto;
				border-radius: 6px;
				margin-top: 0.5rem;
			}
			hr {
				width: 100%;
				max-width: 100%;
				margin: 1rem 0;
				border-top: 1px solid var(--border-color);
			}
		</style>
	</head>
	<body>
		<div class="wrapper">
			<Header />
			<main class="main">
				<div class="container">
					<div class="page home">
						<div class="home-profile">
							<div class="home-avatar">
								<a href="/blog" title="Blog">
									<Image src={Avatar} alt="avatar.png" class="avatar" width={256} height={256} />
								</a>
							</div>
							<h1 class="home-title">{USER_NAME}</h1>
							<div class="home-subtitle">{SITE_DESCRIPTION}</div>
							
							<div class="links">
								{SOCIAL_LINKS.map((link) => (
									<a href={link.href} target="_blank" title={link.title} rel="noopener noreffer me">
										<i class={link.icon}></i>
									</a>
								))}
							</div>
							<hr />
							<img 
								src={`https://ghchart.rshah.org/${GITHUB_USERNAME}`} 
								alt={`${USER_NAME}'s Github Chart`} 
								class="github-chart" 
								id="github-chart"
								data-username={GITHUB_USERNAME}
							/>
						</div>
					</div>
				</div>
			</main>
			<Footer />
		</div>

		<script is:inline>
			function updateGithubChart() {
				const chart = document.getElementById('github-chart');
				if (!chart) return;
				
				const username = chart.dataset.username;
				const isDark = document.documentElement.classList.contains('dark');
				if (isDark) {
					chart.src = `https://ghchart.rshah.org/2d89ef/${username}`;
				} else {
					chart.src = `https://ghchart.rshah.org/${username}`;
				}
			}

			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', updateGithubChart);
			} else {
				updateGithubChart();
			}

			window.addEventListener('theme-change', () => {
				updateGithubChart();
			});
		</script>
	</body>
</html>